<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Dataset Explorer</title>
  <style>
    /* Basic styling for the explorer */
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
    }
    .search-bar {
      margin-bottom: 20px;
    }
    .tags {
      margin-bottom: 20px;
    }
    .tag {
      display: inline-block;
      background-color: #eee;
      padding: 5px 10px;
      margin: 5px;
      border-radius: 5px;
      cursor: pointer;
    }
    .tag.selected {
      background-color: #cce5ff;
    }
    .dataset {
      border: 1px solid #ccc;
      padding: 10px;
      margin-bottom: 10px;
    }
  </style>
</head>
<body>
  <h1>Dataset Explorer</h1>
  <div class="search-bar">
    <input type="text" id="search-input" placeholder="Search datasets...">
  </div>
  <div class="tags" id="tags-container">
    <!-- Tags will be dynamically inserted here -->
  </div>
  <div id="datasets-container">
    <!-- Matching datasets will be displayed here -->
  </div>

  <script>
    // For demonstration, we start with a sample datasets list.
    // Later you could fetch this data from your backend API.
    let datasets = [
      { name: "Dataset A", tags: ["finance", "2020"] },
      { name: "Dataset B", tags: ["health", "2021"] },
      { name: "Dataset C", tags: ["finance", "health", "2020"] },
      { name: "Dataset D", tags: ["education", "2021"] },
    ];

    // Function to render tags
    function renderTags() {
      // Get unique tags from all datasets
      const uniqueTags = [...new Set(datasets.flatMap(ds => ds.tags))];
      const tagsContainer = document.getElementById("tags-container");
      tagsContainer.innerHTML = "";
      uniqueTags.forEach(tag => {
        const tagElem = document.createElement("span");
        tagElem.classList.add("tag");
        tagElem.textContent = tag;
        tagElem.addEventListener("click", () => {
          // Toggle selection state
          tagElem.classList.toggle("selected");
          filterDatasets();
        });
        tagsContainer.appendChild(tagElem);
      });
    }

    // Function to retrieve the list of currently selected tags
    function getSelectedTags() {
      return Array.from(document.getElementsByClassName("tag"))
        .filter(tagElem => tagElem.classList.contains("selected"))
        .map(tagElem => tagElem.textContent);
    }

    // Filter and render datasets based on search input and selected tags
    function filterDatasets() {
      const searchTerm = document.getElementById("search-input").value.toLowerCase();
      const selectedTags = getSelectedTags();
      const datasetsContainer = document.getElementById("datasets-container");
      datasetsContainer.innerHTML = "";

      const filtered = datasets.filter(ds => {
        const matchesSearch = ds.name.toLowerCase().includes(searchTerm);
        const matchesTags = selectedTags.length === 0 ||
                            selectedTags.every(tag => ds.tags.includes(tag));
        return matchesSearch && matchesTags;
      });

      filtered.forEach(ds => {
        const dsElem = document.createElement("div");
        dsElem.classList.add("dataset");
        dsElem.innerHTML = `<strong>${ds.name}</strong><br>Tags: ${ds.tags.join(", ")}`;
        datasetsContainer.appendChild(dsElem);
      });
    }

    // Listen for input changes in the search bar
    document.getElementById("search-input").addEventListener("input", filterDatasets);

    // (Optional) If you want to load datasets from the backend API,
    // you can use the fetch API. For example:
    /*
    fetch('/api/datasets')
      .then(response => response.json())
      .then(data => {
        datasets = data;
        renderTags();
        filterDatasets();
      });
    */

    // Initial render
    renderTags();
    filterDatasets();
  </script>
</body>
</html>

